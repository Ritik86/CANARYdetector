/#!/bin/sh
# Canary Token Detector
# Version 1.0
# This script will detect canary token in word documents
# Author - Ritik trivedi
# www.rtwhitehatsecurity.net
# www.youtube.com/Rt whitehat security
clear
/bin/cat <<'Techchip'
 1111001000000010011101000101010001010000100010000010000110011110100000001100011110010101011011010000111011101000111100010101110111
1010010110011101000001110010011110001110000111101010001000000001010110110110100001000110001011001110100010000011100111011000011001
1110101101101010100000111000110010100011000101011011110100001100010011110101010100011001100011111000000011010011000000111110010001
0100111100010000011010111000110100111011010011100101010011100111011111111001111010010100000010001000001010110001110110011000001011
1010110111000110100101010000010001100011001100101010110010011010011111100001010110000001110011000000011000001011110100000001011111
1111001010101011111000100000111001110011110100011010110001100111001011000001110100011101000000000000011110000000000010001010100000
1011101001111011111010001101100100111011101101010101000000010000100000000011010010100110000101101010000111000000010111000011001010
1011111011011000011001001111001010110010110111010000000101101010110111000111110001000000000001000101001100101001111100000101101001
0101011111000110001110111000001011100111001110010001101101101110010100100010110100110100101110010010000101110010111000110010101000

Rendering time: 1 seconds.                                    
    Your True Tech Navigator        
www.rtwhitehat.net | youtube.com/rtwhitehatsecurity
Techchip
tput setaf 3
echo ""
echo "Canary Token Detector for Microsoft Word Document"
echo "Version 1.0 | Author: TechChip (Anil Parashar) "
echo ""
tput sgr0
read -p "Please Enter Word Document File name : " file
if [ ! -f $file ]
then
echo "File not exists"
exit 1
fi
if [[ $file == *.docx ]] || [[ $file == *.doc ]]
then
unzip -o $file
if [ ! -f word/footer1.xml ]
then
echo ":::::::::::::::::::::::::::"
echo "This file should be normal"
echo ":::::::::::::::::::::::::::"
exit 1
fi
if grep -q canarytoken word/footer2.xml word/footer1.xml word/footer3.xml word/header1.xml word/header2.xml word/header3.xml;
then
echo ":::::::::::::::::::::::::::"
tput setaf 1
tput bel
echo "[x] canary token detected"
tput sgr0
echo ":::::::::::::::::::::::::::"
else
echo ":::::::::::::::::::::::::::"
tput setaf 2
echo "This file is seem normal"
tput sgr0
echo ":::::::::::::::::::::::::::"
fi
rm -rf word docProps _rels
else
echo "This is not a word document file, select correct file"
fi
